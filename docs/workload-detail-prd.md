# 教师工作量详情页面产品需求文档 (PRD)

## 1. 项目概述

### 1.1 项目背景
教师工作量计算系统需要为教师和管理员提供一个统一的工作详情录入和管理界面，支持多种类型的工作量计算和统计。

### 1.2 目标用户
- **教师端**：教师本人填写和查看工作量信息
- **管理员端**：管理员审核和管理教师工作量信息

### 1.3 核心价值
- 提供标准化的工作量录入模板
- 自动计算工作量总分
- 支持多种工作量类型的统一管理
- 简化教师工作量申报流程

## 2. 功能需求

### 2.1 页面整体结构

#### 2.1.1 页面布局
- **顶部区域**：页面标题、返回按钮、保存按钮
- **主体区域**：标签页切换展示不同工作量类型
- **底部区域**：暂无特殊功能

#### 2.1.2 标签页设计
使用NaiveUI的`n-tabs`组件，包含7个标签页：

| 标签页名称 | 标签值 | 颜色标识 | 功能描述 |
|-----------|--------|----------|----------|
| 理论教学工作量 | theory | success | 理论课程教学工作量 |
| 实践教学工作量 | practice | warning | 实践类课程教学工作量 |
| 网络课程教学工作量 | online | info | 在线课程教学工作量 |
| 毕业实习指导工作量 | internship | error | 指导学生毕业实习工作量 |
| 毕业论文指导工作量 | thesis | success | 指导学生毕业论文工作量 |
| 学科竞赛指导工作量 | competition | warning | 指导学生参加竞赛工作量 |
| 教学服务工作量 | service | info | 教学相关服务工作量 |

### 2.2 各类型工作量详细设计

#### 2.2.1 理论教学工作量

**表格展示字段：**
- 课程名称
- 课程代码
- 课时
- 学生人数
- 学期
- 课程类型（必修/选修/公共课）
- 系数
- 总工作量（自动计算）
- 操作（编辑/删除）

**计算公式：**
```
总工作量 = 教学课时 × 学生人数 × 系数
```

**表单字段：**
- 课程名称（必填，文本输入）
- 课程代码（必填，文本输入）
- 教学课时（必填，数字输入，最小值0）
- 学生人数（必填，数字输入，最小值1）
- 学期（必填，下拉选择）
- 课程类型（必填，下拉选择：必修课/选修课/公共课）
- 系数（数字输入，默认值1.0，步长0.1）

#### 2.2.2 实践教学工作量

**表格展示字段：**
- 课程名称
- 实践类型（实验/实训/实习/课程设计）
- 实践课时
- 学生人数
- 分组数
- 学期
- 系数
- 总工作量（自动计算）
- 操作（编辑/删除）

**计算公式：**
```
总工作量 = 实践课时 × 学生人数 × 系数
```

**表单字段：**
- 课程名称（必填，文本输入）
- 实践类型（必填，下拉选择：实验/实训/实习/课程设计）
- 实践课时（必填，数字输入，最小值0）
- 学生人数（必填，数字输入，最小值1）
- 分组数（必填，数字输入，最小值1，默认值1）
- 学期（必填，下拉选择）
- 系数（数字输入，默认值1.0，步长0.1）

#### 2.2.3 网络课程教学工作量

**表格展示字段：**
- 课程名称
- 平台（慕课平台名称）
- 课时
- 学生人数
- 完成率（百分比）
- 学期
- 系数
- 总工作量（自动计算）
- 操作（编辑/删除）

**计算公式：**
```
总工作量 = 课程课时 × 学生人数 × (完成率/100) × 系数
```

**表单字段：**
- 课程名称（必填，文本输入）
- 平台（必填，文本输入）
- 课程课时（必填，数字输入，最小值0）
- 学生人数（必填，数字输入，最小值1）
- 完成率（必填，数字输入，范围0-100）
- 学期（必填，下拉选择）
- 系数（数字输入，默认值1.0，步长0.1）

#### 2.2.4 毕业实习指导工作量

**表格展示字段：**
- 学生姓名
- 学号
- 实习类型
- 开始日期
- 结束日期
- 持续周数（自动计算）
- 学期
- 系数
- 总工作量（自动计算）
- 操作（编辑/删除）

**计算公式：**
```
持续周数 = ceil((结束日期 - 开始日期) / (7天))
总工作量 = 持续周数 × 系数
```

**表单字段：**
- 学生姓名（必填，文本输入）
- 学号（必填，文本输入）
- 实习类型（必填，文本输入）
- 开始日期（必填，日期选择器）
- 结束日期（必填，日期选择器）
- 学期（必填，下拉选择）
- 系数（数字输入，默认值1.0，步长0.1）

#### 2.2.5 毕业论文指导工作量

**表格展示字段：**
- 学生姓名
- 学号
- 论文类型（毕业论文/毕业设计/毕业创作）
- 开始日期
- 结束日期
- 进度（百分比）
- 学期
- 系数
- 总工作量（自动计算）
- 操作（编辑/删除）

**计算公式：**
```
总工作量 = (进度/100) × 20小时 × 系数
```

**表单字段：**
- 学生姓名（必填，文本输入）
- 学号（必填，文本输入）
- 论文类型（必填，下拉选择：毕业论文/毕业设计/毕业创作）
- 开始日期（必填，日期选择器）
- 结束日期（必填，日期选择器）
- 进度（必填，数字输入，范围0-100）
- 学期（必填，下拉选择）
- 系数（数字输入，默认值1.0，步长0.1）

#### 2.2.6 学科竞赛指导工作量

**表格展示字段：**
- 竞赛名称
- 竞赛类型（技能竞赛/学科竞赛/文体活动）
- 学生人数
- 获奖等级（国家级/省级/校级各等级）
- 活动课时
- 学期
- 系数
- 总工作量（自动计算）
- 操作（编辑/删除）

**计算公式：**
```
总工作量 = 活动课时 × 学生人数 × 系数
```

**表单字段：**
- 竞赛名称（必填，文本输入）
- 竞赛类型（必填，下拉选择：技能竞赛/学科竞赛/文体活动）
- 学生人数（必填，数字输入，最小值1）
- 获奖等级（必填，下拉选择：国家级一等奖/二等奖/三等奖，省级各等级，校级各等级）
- 活动课时（必填，数字输入，最小值0）
- 学期（必填，下拉选择）
- 系数（数字输入，默认值1.0，步长0.1）

#### 2.2.7 教学服务工作量

**表格展示字段：**
- 服务类型（教学管理/课程建设/教材编写/教学改革/其他服务）
- 服务内容
- 服务课时
- 服务日期
- 学期
- 系数
- 总工作量（自动计算）
- 操作（编辑/删除）

**计算公式：**
```
总工作量 = 服务课时 × 系数
```

**表单字段：**
- 服务类型（必填，下拉选择：教学管理/课程建设/教材编写/教学改革/其他服务）
- 服务内容（必填，文本域输入）
- 服务课时（必填，数字输入，最小值0）
- 服务日期（必填，日期选择器）
- 学期（必填，下拉选择）
- 系数（数字输入，默认值1.0，步长0.1）

### 2.3 公共组件和功能

#### 2.3.1 学期选择
使用统一的学期选项：
- 2024-2025学年第一学期
- 2024-2025学年第二学期
- 2023-2024学年第一学期
- 2023-2024学年第二学期

#### 2.3.2 系数设置
- 默认值：1.0
- 最小值：0
- 步长：0.1
- 允许手动输入

#### 2.3.3 操作按钮
每个表格行包含：
- **编辑按钮**：打开编辑模态框，预填充当前数据
- **删除按钮**：删除当前行数据，需要二次确认

#### 2.3.4 添加功能
每个标签页顶部包含：
- **添加按钮**：打开对应类型的添加模态框

#### 2.3.5 空数据提示
当表格无数据时显示：
- "暂无{类型}工作量数据"的提示信息
- 使用`n-alert`组件，类型为info

## 3. 技术实现

### 3.1 使用的NaiveUI组件

#### 3.1.1 基础组件
- `NCard`：卡片容器，用于整体布局
- `NSpace`：间距控制
- `NButton`：按钮组件
- `NDivider`：分隔线
- `NAlert`：警告提示
- `NSpin`：加载状态

#### 3.1.2 表单组件
- `NForm`：表单容器
- `NFormItem`：表单项
- `NInput`：文本输入框
- `NInputNumber`：数字输入框
- `NSelect`：下拉选择框
- `NDatePicker`：日期选择器

#### 3.1.3 数据展示组件
- `NTable`：表格组件
- `NTabs`：标签页组件
- `NTabPane`：标签页内容
- `NModal`：模态框
- `NTag`：标签组件

### 3.2 状态管理

#### 3.2.1 响应式数据
- 使用Vue3的`ref`和`reactive`进行状态管理
- 每个工作量类型独立的数据数组
- 模态框的显示/隐藏状态

#### 3.2.2 数据验证
- 使用NaiveUI的表单验证规则
- 必填项验证
- 数值范围验证
- 格式验证

### 3.3 计算逻辑

#### 3.3.1 自动计算
- 实时计算总工作量
- 根据输入参数动态更新
- 保留两位小数显示

#### 3.3.2 日期计算
- 自动计算实习持续周数
- 日期格式化为中文显示

## 4. 交互设计

### 4.1 用户操作流程

#### 4.1.1 添加工作量
1. 选择对应的标签页
2. 点击"添加"按钮
3. 填写表单信息
4. 系统自动计算总工作量
5. 点击"保存"按钮
6. 数据添加到表格中

#### 4.1.2 编辑工作量
1. 在表格中找到需要编辑的行
2. 点击"编辑"按钮
3. 修改表单信息
4. 系统自动重新计算总工作量
5. 点击"保存"按钮
6. 更新表格中的数据

#### 4.1.3 删除工作量
1. 在表格中找到需要删除的行
2. 点击"删除"按钮
3. 确认删除操作
4. 从表格中移除数据

### 4.2 用户体验优化

#### 4.2.1 加载状态
- 保存数据时显示加载动画
- 防止重复提交

#### 4.2.2 操作反馈
- 添加成功提示
- 编辑成功提示
- 删除成功提示
- 错误提示信息

#### 4.2.3 表单交互
- 实时验证输入内容
- 自动计算总工作量
- 合理的默认值设置

## 5. 数据持久化

### 5.1 数据存储
- 前端使用响应式数据存储
- 支持批量保存所有类型的工作量数据
- 提供统一的保存接口

### 5.2 数据加载
- 页面加载时从API获取已有数据
- 支持按工作量ID加载对应数据
- 处理加载失败的情况

## 6. 扩展性考虑

### 6.1 工作量类型扩展
- 支持新增工作量类型
- 每种类型独立配置
- 统一的接口规范

### 6.2 计算公式扩展
- 支持自定义计算公式
- 支持系数配置
- 支持复杂计算逻辑

### 6.3 权限控制
- 支持教师和管理员不同权限
- 支持审核状态管理
- 支持数据锁定机制

## 7. 性能优化

### 7.1 数据渲染
- 使用虚拟滚动处理大量数据
- 分页加载数据
- 懒加载表格内容

### 7.2 表单优化
- 表单验证防抖
- 计算结果缓存
- 减少不必要的重渲染

## 8. 错误处理

### 8.1 表单验证错误
- 显示具体的错误信息
- 高亮错误字段
- 阻止提交无效数据

### 8.2 网络错误
- 显示友好的错误提示
- 提供重试机制
- 离线数据缓存

### 8.3 数据异常
- 处理无效数据
- 提供数据恢复机制
- 记录错误日志